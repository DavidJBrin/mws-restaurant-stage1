var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(e,t){var n=function(r,c){"use strict";if(c.getElementsByClassName){var f,d,p=c.documentElement,i=r.Date,o=r.HTMLPictureElement,a="addEventListener",h="getAttribute",n=r[a],m=r.setTimeout,s=r.requestAnimationFrame||m,u=r.requestIdleCallback,y=/^picture$/i,l=["load","error","lazyincluded","_lazyloaded"],g={},v=Array.prototype.forEach,b=function(e,t){return g[t]||(g[t]=new RegExp("(\\s|^)"+t+"(\\s|$)")),g[t].test(e[h]("class")||"")&&g[t]},_=function(e,t){b(e,t)||e.setAttribute("class",(e[h]("class")||"").trim()+" "+t)},E=function(e,t){var n;(n=b(e,t))&&e.setAttribute("class",(e[h]("class")||"").replace(n," "))},C=function e(t,n,r){var o=r?a:"removeEventListener";r&&e(t,n),l.forEach(function(e){t[o](e,n)})},z=function(e,t,n,r,o){var i=c.createEvent("CustomEvent");return n||(n={}),n.instance=f,i.initCustomEvent(t,!r,!o,n),e.dispatchEvent(i),i},A=function(e,t){var n;!o&&(n=r.picturefill||d.pf)?n({reevaluate:!0,elements:[e]}):t&&t.src&&(e.src=t.src)},B=function(e,t){return(getComputedStyle(e,null)||{})[t]},w=function(e,t,n){for(n=n||e.offsetWidth;n<d.minSize&&t&&!e._lazysizesWidth;)n=t.offsetWidth,t=t.parentNode;return n},k=(Ce=[],ze=Ee=[],(Be=function(e,t){be&&!t?e.apply(this,arguments):(ze.push(e),_e||(_e=!0,(c.hidden?m:s)(Ae)))})._lsFlush=Ae=function(){var e=ze;for(ze=Ee.length?Ce:Ee,_e=!(be=!0);e.length;)e.shift()();be=!1},Be),e=function(n,e){return e?function(){k(n)}:function(){var e=this,t=arguments;k(function(){n.apply(e,t)})}},x=function(e){var t,n,r=function(){t=null,e()},o=function e(){var t=i.now()-n;t<99?m(e,99-t):(u||r)(r)};return function(){n=i.now(),t||(t=m(o,99))}};!function(){var e,t={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:!0,expFactor:1.5,hFac:.8,loadMode:2,loadHidden:!0,ricTimeout:0,throttleDelay:125};for(e in d=r.lazySizesConfig||r.lazysizesConfig||{},t)e in d||(d[e]=t[e]);r.lazySizesConfig=d,m(function(){d.init&&D()})}();var t=(ne=/^img$/i,re=/^iframe$/i,oe="onscroll"in r&&!/glebot/.test(navigator.userAgent),se=-1,ue=function e(t){ae--,t&&t.target&&C(t.target,e),(!t||ae<0||!t.target)&&(ae=0)},le=function(e,t){var n,r=e,o="hidden"==B(c.body,"visibility")||"hidden"!=B(e,"visibility");for(F-=t,U+=t,q-=t,K+=t;o&&(r=r.offsetParent)&&r!=c.body&&r!=p;)(o=0<(B(r,"opacity")||1))&&"visible"!=B(r,"overflow")&&(n=r.getBoundingClientRect(),o=K>n.left&&q<n.right&&U>n.top-1&&F<n.bottom+1);return o},J=ce=function(){var e,t,n,r,o,i,a,s,u,l=f.elements;if((P=d.loadMode)&&ae<8&&(e=l.length)){t=0,se++,null==V&&("expand"in d||(d.expand=500<p.clientHeight&&500<p.clientWidth?500:370),$=d.expand,V=$*d.expFactor),ie<V&&ae<1&&2<se&&2<P&&!c.hidden?(ie=V,se=0):ie=1<P&&1<se&&ae<6?$:0;for(;t<e;t++)if(l[t]&&!l[t]._lazyRace)if(oe)if((s=l[t][h]("data-expand"))&&(i=1*s)||(i=ie),u!==i&&(O=innerWidth+i*G,W=innerHeight+i,a=-1*i,u=i),n=l[t].getBoundingClientRect(),(U=n.bottom)>=a&&(F=n.top)<=W&&(K=n.right)>=a*G&&(q=n.left)<=O&&(U||K||q||F)&&(d.loadHidden||"hidden"!=B(l[t],"visibility"))&&(L&&ae<3&&!s&&(P<3||se<4)||le(l[t],i))){if(ge(l[t]),o=!0,9<ae)break}else!o&&L&&!r&&ae<4&&se<4&&2<P&&(I[0]||d.preloadAfterLoad)&&(I[0]||!s&&(U||K||q||F||"auto"!=l[t][h](d.sizesAttr)))&&(r=I[0]||l[t]);else ge(l[t]);r&&!o&&ge(r)}},X=ae=ie=0,Y=d.throttleDelay,Z=d.ricTimeout,ee=function(){Q=!1,X=i.now(),J()},te=u&&49<Z?function(){u(ee,{timeout:Z}),Z!==d.ricTimeout&&(Z=d.ricTimeout)}:e(function(){m(ee)},!0),fe=function(e){var t;(e=!0===e)&&(Z=33),Q||(Q=!0,(t=Y-(i.now()-X))<0&&(t=0),e||t<9?te():m(te,t))},pe=e(de=function(e){_(e.target,d.loadedClass),E(e.target,d.loadingClass),C(e.target,he),z(e.target,"lazyloaded")}),he=function(e){pe({target:e.target})},me=function(e){var t,n=e[h](d.srcsetAttr);(t=d.customMedia[e[h]("data-media")||e[h]("media")])&&e.setAttribute("media",t),n&&e.setAttribute("srcset",n)},ye=e(function(e,t,n,r,o){var i,a,s,u,l,c;(l=z(e,"lazybeforeunveil",t)).defaultPrevented||(r&&(n?_(e,d.autosizesClass):e.setAttribute("sizes",r)),a=e[h](d.srcsetAttr),i=e[h](d.srcAttr),o&&(s=e.parentNode,u=s&&y.test(s.nodeName||"")),c=t.firesLoad||"src"in e&&(a||i||u),l={target:e},c&&(C(e,ue,!0),clearTimeout(N),N=m(ue,2500),_(e,d.loadingClass),C(e,he,!0)),u&&v.call(s.getElementsByTagName("source"),me),a?e.setAttribute("srcset",a):i&&!u&&(re.test(e.nodeName)?function(t,n){try{t.contentWindow.location.replace(n)}catch(e){t.src=n}}(e,i):e.src=i),o&&(a||u)&&A(e,{src:i})),e._lazyRace&&delete e._lazyRace,E(e,d.lazyClass),k(function(){(!c||e.complete&&1<e.naturalWidth)&&(c?ue(l):ae--,de(l))},!0)}),ve=function e(){if(!L){if(i.now()-j<999)return void m(e,999);var t=x(function(){d.loadMode=3,fe()});L=!0,d.loadMode=3,fe(),n("scroll",function(){3==d.loadMode&&(d.loadMode=2),t()},!0)}},{_:function(){j=i.now(),f.elements=c.getElementsByClassName(d.lazyClass),I=c.getElementsByClassName(d.lazyClass+" "+d.preloadClass),G=d.hFac,n("scroll",fe,!0),n("resize",fe,!0),r.MutationObserver?new MutationObserver(fe).observe(p,{childList:!0,subtree:!0,attributes:!0}):(p[a]("DOMNodeInserted",fe,!0),p[a]("DOMAttrModified",fe,!0),setInterval(fe,999)),n("hashchange",fe,!0),["focus","mouseover","click","load","transitionend","animationend","webkitAnimationEnd"].forEach(function(e){c[a](e,fe,!0)}),/d$|^c/.test(c.readyState)?ve():(n("load",ve),c[a]("DOMContentLoaded",fe),m(ve,2e4)),f.elements.length?(ce(),k._lsFlush()):fe()},checkElems:fe,unveil:ge=function(e){var t,n=ne.test(e.nodeName),r=n&&(e[h](d.sizesAttr)||e[h]("sizes")),o="auto"==r;(!o&&L||!n||!e[h]("src")&&!e.srcset||e.complete||b(e,d.errorClass)||!b(e,d.lazyClass))&&(t=z(e,"lazyunveilread").detail,o&&R.updateElem(e,!0,e.offsetWidth),e._lazyRace=!0,ae++,ye(e,t,o,r,n))}}),R=(S=e(function(e,t,n,r){var o,i,a;if(e._lazysizesWidth=r,r+="px",e.setAttribute("sizes",r),y.test(t.nodeName||""))for(o=t.getElementsByTagName("source"),i=0,a=o.length;i<a;i++)o[i].setAttribute("sizes",r);n.detail.dataAttr||A(e,n.detail)}),T=function(e,t,n){var r,o=e.parentNode;o&&(n=w(e,o,n),r=z(e,"lazybeforesizes",{width:n,dataAttr:!!t}),r.defaultPrevented||(n=r.detail.width)&&n!==e._lazysizesWidth&&S(e,o,r,n))},{_:function(){M=c.getElementsByClassName(d.autosizesClass),n("resize",H)},checkElems:H=x(function(){var e,t=M.length;if(t)for(e=0;e<t;e++)T(M[e])}),updateElem:T}),D=function e(){e.i||(e.i=!0,R._(),t._())};return f={cfg:d,autoSizer:R,loader:t,init:D,uP:A,aC:_,rC:E,hC:b,fire:z,gW:w,rAF:k}}var M,S,T,H;var I,L,N,P,j,O,W,F,q,K,U,$,V,G,J,Q,X,Y,Z,ee,te,ne,re,oe,ie,ae,se,ue,le,ce,fe,de,pe,he,me,ye,ge,ve;var be,_e,Ee,Ce,ze,Ae,Be}(e,e.document);e.lazySizes=n,"object"==("undefined"==typeof module?"undefined":_typeof(module))&&module.exports&&(module.exports=n)}(window),function(){"use strict";function a(n){return new Promise(function(e,t){n.onsuccess=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function i(n,r,o){var i,e=new Promise(function(e,t){a(i=n[r].apply(n,o)).then(e,t)});return e.request=i,e}function e(e,n,t){t.forEach(function(t){Object.defineProperty(e.prototype,t,{get:function(){return this[n][t]},set:function(e){this[n][t]=e}})})}function t(t,n,r,e){e.forEach(function(e){e in r.prototype&&(t.prototype[e]=function(){return i(this[n],e,arguments)})})}function n(t,n,r,e){e.forEach(function(e){e in r.prototype&&(t.prototype[e]=function(){return this[n][e].apply(this[n],arguments)})})}function r(e,r,t,n){n.forEach(function(n){n in t.prototype&&(e.prototype[n]=function(){return e=this[r],(t=i(e,n,arguments)).then(function(e){if(e)return new s(e,t.request)});var e,t})})}function o(e){this._index=e}function s(e,t){this._cursor=e,this._request=t}function u(e){this._store=e}function l(n){this._tx=n,this.complete=new Promise(function(e,t){n.oncomplete=function(){e()},n.onerror=function(){t(n.error)},n.onabort=function(){t(n.error)}})}function c(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new l(n)}function f(e){this._db=e}e(o,"_index",["name","keyPath","multiEntry","unique"]),t(o,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),r(o,"_index",IDBIndex,["openCursor","openKeyCursor"]),e(s,"_cursor",["direction","key","primaryKey","value"]),t(s,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(n){n in IDBCursor.prototype&&(s.prototype[n]=function(){var t=this,e=arguments;return Promise.resolve().then(function(){return t._cursor[n].apply(t._cursor,e),a(t._request).then(function(e){if(e)return new s(e,t._request)})})})}),u.prototype.createIndex=function(){return new o(this._store.createIndex.apply(this._store,arguments))},u.prototype.index=function(){return new o(this._store.index.apply(this._store,arguments))},e(u,"_store",["name","keyPath","indexNames","autoIncrement"]),t(u,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),r(u,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),n(u,"_store",IDBObjectStore,["deleteIndex"]),l.prototype.objectStore=function(){return new u(this._tx.objectStore.apply(this._tx,arguments))},e(l,"_tx",["objectStoreNames","mode"]),n(l,"_tx",IDBTransaction,["abort"]),c.prototype.createObjectStore=function(){return new u(this._db.createObjectStore.apply(this._db,arguments))},e(c,"_db",["name","version","objectStoreNames"]),n(c,"_db",IDBDatabase,["deleteObjectStore","close"]),f.prototype.transaction=function(){return new l(this._db.transaction.apply(this._db,arguments))},e(f,"_db",["name","version","objectStoreNames"]),n(f,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(i){[u,o].forEach(function(e){i in e.prototype&&(e.prototype[i.replace("open","iterate")]=function(){var e,t=(e=arguments,Array.prototype.slice.call(e)),n=t[t.length-1],r=this._store||this._index,o=r[i].apply(r,t.slice(0,-1));o.onsuccess=function(){n(o.result)}})})}),[o,u].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,n){var r=this,o=[];return new Promise(function(t){r.iterateCursor(e,function(e){e?(o.push(e.value),void 0===n||o.length!=n?e.continue():t(o)):t(o)})})})});var d={open:function(e,t,n){var r=i(indexedDB,"open",[e,t]),o=r.request;return o&&(o.onupgradeneeded=function(e){n&&n(new c(o.result,e.oldVersion,o.transaction))}),r.then(function(e){return new f(e)})},delete:function(e){return i(indexedDB,"deleteDatabase",[e])}};"undefined"!=typeof module?(module.exports=d,module.exports.default=module.exports):self.idb=d}();var map,DBHelper=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"openDatabase",value:function(){if(!navigator.serviceWorker)return Promise.resolve();this.DBPromised=idb.open("mws-restaurants",1,function(e){e.createObjectStore("restaurants",{keyPath:"id"})})}},{key:"fetchRestaurants",value:function(r){fetch(a.DATABASE_URL).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json().then(function(n){a.DBPromised.then(function(e){if(e){var t=e.transaction("restaurants","readwrite").objectStore("restaurants");n.forEach(function(e){t.put(e)})}}),r(null,n)})}).catch(function(t){a.DBPromised.then(function(e){e.transaction("restaurants").objectStore("restaurants").getAll().then(function(e){e||r(t.message,null),r(null,e)})}),r("An error occurred: "+t.message,null)})}},{key:"fetchRestaurantById",value:function(r,o){a.fetchRestaurants(function(e,t){if(e)o(e,null);else{var n=t.find(function(e){return e.id==r});n?o(null,n):o("Restaurant does not exist",null)}})}},{key:"fetchRestaurantByCuisine",value:function(r,o){a.fetchRestaurants(function(e,t){if(e)o(e,null);else{var n=t.filter(function(e){return e.cuisine_type==r});o(null,n)}})}},{key:"fetchRestaurantByNeighborhood",value:function(r,o){a.fetchRestaurants(function(e,t){if(e)o(e,null);else{var n=t.filter(function(e){return e.neighborhood==r});o(null,n)}})}},{key:"fetchRestaurantByCuisineAndNeighborhood",value:function(r,o,i){a.fetchRestaurants(function(e,t){if(e)i(e,null);else{var n=t;"all"!=r&&(n=n.filter(function(e){return e.cuisine_type==r})),"all"!=o&&(n=n.filter(function(e){return e.neighborhood==o})),i(null,n)}})}},{key:"fetchNeighborhoods",value:function(o){a.fetchRestaurants(function(e,n){if(e)o(e,null);else{var r=n.map(function(e,t){return n[t].neighborhood}),t=r.filter(function(e,t){return r.indexOf(e)==t});o(null,t)}})}},{key:"fetchCuisines",value:function(o){a.fetchRestaurants(function(e,n){if(e)o(e,null);else{var r=n.map(function(e,t){return n[t].cuisine_type}),t=r.filter(function(e,t){return r.indexOf(e)==t});o(null,t)}})}},{key:"urlForRestaurant",value:function(e){return"./restaurant.html?id="+e.id}},{key:"imageUrlForRestaurant",value:function(e){return e.photograph?"/img/"+e.photograph:"/img/default"}},{key:"imageExtForURL",value:function(e){return"/img/default"===e?"png":"jpg"}},{key:"mapMarkerForRestaurant",value:function(e,t){return new google.maps.Marker({position:e.latlng,title:e.name,url:a.urlForRestaurant(e),map:t,animation:google.maps.Animation.DROP})}},{key:"DATABASE_URL",get:function(){return"http://localhost:1337/restaurants/"}}]),a}(),restaurants=void 0,neighborhoods=void 0,cuisines=void 0,markers=[];registerServiceWorker=function(){"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js",{scope:"/"}).then(function(){return console.log("Service Worker Registered!")}).catch(function(e){return console.log("Service Worker Registration Error!",e)})},registerServiceWorker(),DBHelper.openDatabase(),document.addEventListener("DOMContentLoaded",function(e){fetchNeighborhoods(),fetchCuisines()}),fetchNeighborhoods=function(){DBHelper.fetchNeighborhoods(function(e,t){e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})},fillNeighborhoodsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.neighborhoods,n=document.getElementById("neighborhoods-select");e.forEach(function(e){var t=document.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})},fetchCuisines=function(){DBHelper.fetchCuisines(function(e,t){e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})},fillCuisinesHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.cuisines,n=document.getElementById("cuisines-select");e.forEach(function(e){var t=document.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})},window.initMap=function(){self.map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1}),updateRestaurants()},updateRestaurants=function(){var e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),n=e.selectedIndex,r=t.selectedIndex,o=e[n].value,i=t[r].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(o,i,function(e,t){e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})},resetRestaurants=function(e){self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers.forEach(function(e){return e.setMap(null)}),self.markers=[],self.restaurants=e},fillRestaurantsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants,t=document.getElementById("restaurants-list");e.forEach(function(e){t.append(createRestaurantHTML(e))}),addMarkersToMap()},createRestaurantHTML=function(e){var t=document.createElement("li"),n=DBHelper.imageUrlForRestaurant(e),r=DBHelper.imageExtForURL(n),o=document.createElement("img");o.className="restaurant-img lazyload",o.dataset.srcset=n+"-small."+r+" 1x, "+n+"-large."+r+" 2x",o.alt="An image of "+e.name,t.append(o);var i=document.createElement("h1");i.innerHTML=e.name,t.append(i);var a=document.createElement("p");a.innerHTML=e.neighborhood,t.append(a);var s=document.createElement("p");s.innerHTML=e.address,t.append(s);var u=document.createElement("a");return u.innerHTML="View Details",u.href=DBHelper.urlForRestaurant(e),u.setAttribute("aria-label","View Details Of "+e.name),t.append(u),t},addMarkersToMap=function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants).forEach(function(e){var t=DBHelper.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(t,"click",function(){window.location.href=t.url}),self.markers.push(t)})};